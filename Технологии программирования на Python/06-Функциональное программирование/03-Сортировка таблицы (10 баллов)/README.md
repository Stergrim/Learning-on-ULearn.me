# Сортировка таблицы

И вот, настал этап, когда Василию надо было сдавать программу в отдел аналитики. Для этого требовалось доработать еще небольшую функциональность к таблице, после этого, требовалось пройти код-ревью у старших коллег-программистов, перед тем, как полностью отдать программу в отдел аналитики на эксплуатацию и заниматься ее дальшнейшим сопровождением.

Васю в дополнение к предыдущим возможностям, попросили сделать сортировку таблицы по разным столбцам. По полям "Оклад", "Опыт работы" и "Дата публикации вакансии". С возможностью сортировки как порядке возрастания, так и в порядке убывания. Тут же Вася вспомнил, что в Python есть замечательная встроенная функция sort, которую можно было бы применить для решения этой задачи.

Вот какое ТЗ написал сам себе Василий на основании последних требований из отдела аналитики:
1. Сохраняется вся предыдущая функциональность.
2. Первая строка входных данных - название CSV с вакансиями для обработки.
3. Во второй строке ввода ожидается параметр фильтрации например: ’Компания: Аконит-Урал’.
4. В третьей строке ввода ожидается название столбца, по которому будет происходить сортировка.
5. В четвертой строке ввода ожидается указание обратного порядка сортировка: `Да`, если сортировка идёт от большего к меньшему, и `Нет`, если сортировка идёт от меньшего к большему.
6. Пятая строка порядковые номера вакансий - нумерация в пределах отфильтрованных данных.
7. Шестая строка Названия столбцов, которые нужно выводить в таблице - функционал прежний.
8. Параметр сортировки принимает название столбцов "Оклад", "Опыт работы" и "Дата публикации вакансии".
9. Сортировка по окладу - в порядке возрастания максимального оклада.
10. Сортировка по опыту работы - в порядке возрастания опыта работы.
11. Сортировка по дате - старых к новым (при равенстве дат учитывать время).
12. Если в поле "Обратный порядок сортировки" установлено “Да”, то описанный выше порядок изменить на противоположный.
13. Если в поле "Параметр сортировки" Указано пустое значение, сортировку не применять.
14. Если в поле “Обратный порядок сортировки” Указано пустое значение, то оставить порядок нормальным.


**Формат ввода**

```
vacancies.csv
Опыт работы: От 3 до 6 лет
Оклад
Нет
1 10
Название, Навыки, Оклад
```

[Скачать пример файла](example.zip)

**Формат вывода**

```
+----+----------------------+----------------------+----------------------+
| №  | Название             | Навыки               | Оклад                |
+----+----------------------+----------------------+----------------------+
| 1  | Начальник            | Пользователь ПК,     | 40 000 - 45 000      |
|    | транспортного        | Подбор               | (Рубли) (С вычетом   |
|    | участка              | производственного    | налогов)             |
|    |                      | персонала, Охрана    |                      |
|    |                      | труда и техника      |                      |
|    |                      | безопасности,        |                      |
|    |                      | Организато...        |                      |
+----+----------------------+----------------------+----------------------+
| 2  | Механик/контролер по | Пользователь ПК,     | 55 000 - 55 000      |
|    | выпуску транспортных | Ведение              | (Рубли) (С вычетом   |
|    | средств на линию     | документации, Работа | налогов)             |
|    |                      | с большим объемом    |                      |
|    |                      | информации,          |                      |
|    |                      | Управление офисными  |                      |
|    |                      | води...              |                      |
|    |                      |                      |                      |
+----+----------------------+----------------------+----------------------+
| 3  | Специалист           | Проведение           | 60 000 - 75 000      |
|    | технического отдела  | семинаров,           | (Рубли) (С вычетом   |
|    |                      | Проведение           | налогов)             |
|    |                      | презентаций,         |                      |
|    |                      | подготовка технико-  |                      |
|    |                      | коммерческих         |                      |
|    |                      | предложений,         |                      |
|    |                      | Техническ...         |                      |
+----+----------------------+----------------------+----------------------+
| 4  | Инженер слаботочных  | AutoCAD, Чтение      | 60 000 - 80 000      |
|    | систем               | чертежей,            | (Рубли) (Без вычета  |
|    |                      | Строительство,       | налогов)             |
|    |                      | Контроль качества,   |                      |
|    |                      | Инженерные системы   |                      |
|    |                      |                      |                      |
|    |                      |                      |                      |
+----+----------------------+----------------------+----------------------+
| 5  | Web-разработчик /    | MySQL, PHP, HTML5,   | 70 000 - 80 000      |
|    | Специалист по        | jQuery, CMS          | (Рубли) (С вычетом   |
|    | интернет-продвижению | Wordpress, Figma,    | налогов)             |
|    |                      | SEO, SEO             |                      |
|    |                      | оптимизация, CSS,    |                      |
|    |                      | Yii2, Продвижение    |                      |
|    |                      | сайтов...            |                      |
|    |                      |                      |                      |
+----+----------------------+----------------------+----------------------+
| 6  | Программист 1С       | 1С: Предприятие 8,   | 50 000 - 80 000      |
|    |                      | 1С программирование, | (Рубли) (С вычетом   |
|    |                      | Грамотность, 1С:     | налогов)             |
|    |                      | Бухгалтерия, 1С:     |                      |
|    |                      | Зарплата и           |                      |
|    |                      | управление перс...   |                      |
|    |                      |                      |                      |
|    |                      |                      |                      |
+----+----------------------+----------------------+----------------------+
| 7  | Ведущий инженер-     | Git, Linux, MATLAB,  | 88 000 - 88 000      |
|    | программист          | Python, Qt           | (Рубли) (Без вычета  |
|    |                      |                      | налогов)             |
|    |                      |                      |                      |
|    |                      |                      |                      |
|    |                      |                      |                      |
|    |                      |                      |                      |
+----+----------------------+----------------------+----------------------+
| 8  | Аналитик 1С по       | Разработка           | 30 000 - 90 000      |
|    | регламентированному  | инструкций, Высокие  | (Рубли) (Без вычета  |
|    | учёту                | коммуникативные      | налогов)             |
|    |                      | навыки, Разработка   |                      |
|    |                      | технических заданий, |                      |
|    |                      | Уверенное зна...     |                      |
|    |                      |                      |                      |
+----+----------------------+----------------------+----------------------+
| 9  | Руководитель проекта | Организаторские      | 80 000 - 100 000     |
|    | по системам связи и  | навыки, Проведение   | (Рубли) (С вычетом   |
|    | информационным       | презентаций, MS      | налогов)             |
|    | технологиям          | PowerPoint,          |                      |
|    |                      | Информационные       |                      |
|    |                      | технологии,          |                      |
|    |                      | Аналитичес...        |                      |
+----+----------------------+----------------------+----------------------+
| 10 | Руководитель         | Ведение переговоров, | 80 000 - 100 000     |
|    | проектов             | Организаторские      | (Рубли) (С вычетом   |
|    |                      | навыки, Деловая      | налогов)             |
|    |                      | переписка, Работа в  |                      |
|    |                      | команде, Деловое     |                      |
|    |                      | общение              |                      |
|    |                      |                      |                      |
+----+----------------------+----------------------+----------------------+
```

|                         |               |
|:------------------------|:--------------|
| **Ограничение времени** | **1 секунда** |
| **Ограничение памяти**  | **64.0 Мб**   |


Все тесты пройдены, задача сдана:
```py
import csv
import re
from datetime import datetime
from prettytable import PrettyTable, ALL

def format_row(cell):
    formatted_row = cell.strip()
    if "\n" in formatted_row:
        formatted_row = ", ".join(formatted_row.split("\n"))
    return formatted_row if len(formatted_row) <= 100 else formatted_row[:100] + "..."

def get_range(rows, columns):
    range = {}
    if rows:
        nums = [int(n) for n in rows.split()]
        range["start"] = nums[0] - 1
        if len(nums) > 1: range["end"] = nums[1]

    if columns:
        strings = columns.split(", ")
        strings.append("№")
        range["fields"] = strings
    return range

def filter_data(data, filter_parameters):
    filter, value = filter_parameters.split(": ")
    filtered_data = []
    for vacancy in data:
        if filter == "Оклад":
            salary = [int(n.replace(" ", "")) for n in re.findall(r"\d{1,3}(?:\s\d{3})*", vacancy["Оклад"])]
            if salary[0] <= int(value) <= salary[1]: filtered_data.append(vacancy)
        elif filter == "Идентификатор валюты оклада":
            if value in vacancy["Оклад"]: filtered_data.append(vacancy)
        else:
            if value in vacancy[filter]: filtered_data.append(vacancy)
    return  filtered_data

def sort_data(data, field, is_reverse):
    if field == "Оклад":
        data.sort(key=lambda v: int(re.findall(r"\d{1,3}(?:\s\d{3})*", v["Оклад"])[1].replace(" ", "")), reverse=is_reverse)
    elif field == "Опыт работы":
        data.sort(key=lambda v: (
            numbers := re.findall(r"\d+", v["Опыт работы"]),
            int(numbers[0]) if numbers else 0
        ), reverse=is_reverse)
    elif field == "Дата публикации вакансии":
        data.sort(key=lambda v: datetime.strptime(v["Дата публикации вакансии"], "%H:%M:%S %d/%m/%Y"), reverse=is_reverse)
    return data

def get_table(titles, vacancies):
    if not vacancies:
        print("Нет данных")
        return

    table = PrettyTable(hrules=ALL)
    table.field_names = ["№"] + titles
    for field in table.field_names:
        table.align[field] = "l"
    for i, vacancy in enumerate(vacancies, start=1):
        row = [i]
        for field in titles:
            row.append(format_row(vacancy[field]))
        table.add_row(row)

    table.max_width = 20
    return table

def csv_reader(file_name):
    with open(file_name, encoding="utf-8") as f:
        reader = csv.DictReader(f)
        titles = reader.fieldnames
        data = [v for v in reader]
    return titles, data

def main():
    file_name = input()
    filter_parameters = input()
    sort_field = input()
    is_reverse = input()
    range = get_range(input(), input())

    titles, vacancies = csv_reader(file_name)
    if filter_parameters:
        vacancies = filter_data(vacancies, filter_parameters)
    if sort_field:
        vacancies = sort_data(vacancies, sort_field, True if is_reverse == "Да" else False)

    table = get_table(titles, vacancies)
    print(table.get_string(**range))

if __name__ == '__main__':
    main()
```
