# Меняем csv

Вася несколько дней без еды и отдыха составлял базу данных о вакансиях в csv-файл и, когда уже составил, узнал об изменении стандартов записи. Пока Вася лежит в обмороке, поменяйте все записи в файле на необходимый формат.

На сайте стандарта по оформлению базы данных в csv формате вышла инструкция, в каком порядке нужно применять изменения:
1. Необходимо поменять всё время, записанное в формате HH.ii (`14.00`) на HH:ii (`14:00`)
2. Убрать из текста все HTML-теги (например, `<p>`)
3. Поменять все конструкции дата-время следующего вида YYYY-mm-ddTHH:ii:ss+ZZZZ (`2017-06-26T15:00:03+0300`) на формат HH:ii:ss dd/mm/YYYY (`15:00:03 26/06/2017`)

Перед падением в обморок Вася решил выделить ключевые слова вакансий: все слова, идентичные или частично содержащие ключевое слово (независимо от регистра) должны быть выделены заглавными буквами.

Например:
```
# ключевое слово "exam"
here some example for your Exam -> here some EXAMPLE for your EXAM

# ключевое слово "раб"
Вася решил устроиться на работу Python-Разработчиком ->
Вася решил устроиться на РАБОТУ Python-РАЗРАБОТЧИКОМ

# ключевое слово "сок"
Вася съел кусок торта, запил его апельсиновым соком, сидя на высокой табуретке ->
Вася съел КУСОК торта, запил его апельсиновым СОКОМ, сидя на ВЫСОКОЙ табуретке
```

**Формат ввода**

Первой строкой на вход подаётся название искомого csv-файла.

Второй строкой подаётся название, под которым необходимо сохранить требуемый csv-файл, учитывающий все требования.

Третьей строкой подаются ключевые слова, которые необходимо выделить в файле. Если слово в тексте содержит ключевое слово (ключевое слово является подстрокой слова из текста), его также необходимо выделить. Ключевые слова разделены запятой.

```
example.csv
my_answer.csv
exam,answer,vasya
```

**Пример формата текста искомого csv-файла**

```
Преподаватель программирования,"<p>Увлечён программированием, компьютерными играми? Предлагаем познакомить детей с миром программирования и проводить занятия так, чтобы ребенку хотелось погружаться ещё и ещё!</p>","Преподаватель
Организация учебного процесса
Обучение
HTML
CSS",noExperience,False,СФЕРА,20000.0,50000.0,False,RUR,Тюмень,2021-10-18T19:22:07+0300
```

**Пример формата текста результирующего файла**

```
Преподаватель ПРОГРАММИРОВАНИЯ,"Увлечён ПРОГРАММИРОВАНИЕМ, компьютерными играми? Предлагаем познакомить детей с миром ПРОГРАММИРОВАНИЯ и проводить занятия так, чтобы ребенку хотелось погружаться ещё и ещё!","Преподаватель
Организация учебного процесса
Обучение
HTML
CSS",noExperience,False,СФЕРА,20000.0,50000.0,False,RUR,Тюмень,19:22:07 18/10/2021
```

|                         |               |
|:------------------------|:--------------|
| **Ограничение времени** | **4 секунды** |
| **Ограничение памяти**  | **128.0 Мб**  |


Все тесты пройдены, задача сдана:
```py
import re

file = input().strip()
new_file = input().strip()
highlight = input().strip()
keywords = [kw.strip() for kw in highlight.split(',') if kw.strip()]

def normalize_html(text: str) -> str:
    return re.sub(r"<[^>]+>", "", text)

def normalize_time(s: str) -> str:
    return re.sub(r'(?<!\d)((?:[01]?\d|2[0-3]))\.([0-5]\d)(?!\d)', r'\1:\2', s)

def normalize_date(s: str) -> str:
    return re.sub(r'(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[+-]\d{2}:?\d{2})', r'\4:\5:\6 \3/\2/\1', s)

def find_highlights(highlights, text: str) -> str:
    for h in highlights:
        pat = re.compile(rf'(?i)\b\w*(?:{re.escape(h)})\w*\b')
        text = pat.sub(lambda m: m.group(0).upper(), text)
    return text

with open(file, 'r', encoding='utf-8') as f:
    data = f.read()

data = normalize_time(data)
data = normalize_html(data)
data = normalize_date(data)
data = find_highlights(keywords, data)

with open(new_file, 'w', encoding='utf-8') as f:
    f.write(data)
```
